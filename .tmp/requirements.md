# 要件定義書（Requirements Specification）

## プロジェクト名
**BlueprintEmulator（ブループリントエミュレーター）**
UE5教案自動生成システム

## 1. プロジェクト概要

### 1.1 目的
高校生向けプログラム教室で使用するUnreal Engine 5（UE5）の学習教案を自動生成するシステムを開発する。教師/講師がテーマを指定するだけで、体系的な学習コンテンツが自動作成され、HTML形式で出力される。

**対象バージョン**: Unreal Engine 5.6 (UE5.6)

### 1.2 背景と課題
- UE5の教案作成には専門知識と時間が必要
- 高校生に適したレベルで、段階的に学習できる教材が不足
- ブループリント中心の実践的な教材が求められている
- 教案の品質にばらつきがある
- **UE5は頻繁にアップデートされ、古い情報が氾濫している**
- **最新バージョン（UE5.6）に対応した正確な情報が必要**

### 1.3 期待される効果
- 教案作成時間の大幅な削減（数時間→数分）
- 一貫性のある高品質な教材の提供
- **UE5.6の最新機能を反映した教材の迅速な作成**
- **常に最新の正確な情報に基づいた教案の提供**
- 高校生の興味を引く実践的な内容の提供

## 2. ユーザー要求

### 2.1 主要ユーザー
- **教師/講師**: 高校のプログラム教室や専門学校でUE5を教える教育者
- **副次的ユーザー（将来的）**: 高校生（自習用教材として利用）

### 2.2 ユーザーストーリー
- **US-001**: 教師として、テーマを入力すると自動的に教案が生成されるので、準備時間を削減したい
- **US-002**: 教師として、生成された教案にはステップバイステップの手順が含まれているので、授業で説明しやすい
- **US-003**: 教師として、ブループリントのコードや設定方法が具体的に示されているので、実演しやすい
- **US-004**: 教師として、HTML形式で出力されるので、ブラウザで表示したり印刷したりできる
- **US-005**: 教師として、高校生の興味を引く実践的なテーマ（必殺技演出など）を扱えるので、学習意欲を高められる

## 3. 機能要件

### 3.1 コア機能

#### FR-001: テーマ入力機能
- **説明**: ユーザーがUE5の学習テーマを自由テキストで入力できる
- **入力例**:
  - "UE5のコントロールリグを使い、自作のアニメーションを作る方法"
  - "そのアニメーションを使って必殺技の演出をつくる"
- **制約**:
  - テーマはUE5に関連する内容に限定
  - 高校生が理解可能なレベルの内容

#### FR-002: 教案自動生成機能
- **説明**: 入力されたテーマに基づいて、体系的な教案を自動生成する
- **生成内容**:
  1. **学習目標**: このテーマで何を学ぶか
  2. **前提知識**: 必要な事前知識やスキル
  3. **使用する機能**: UE5のどの機能を使うか（コントロールリグ、ブループリント、アニメーションシステムなど）
  4. **実装手順**: ステップバイステップの具体的な手順
  5. **ブループリント実装**: 必要なブループリントの構成とノード配置
  6. **設定値**: パラメータや設定の具体的な値
  7. **図解（Diagram）**: ブループリント構造、アニメーションブループリント、タイムラインなどをMermaid.jsで視覚化
  8. **トラブルシューティング**: よくあるエラーと解決方法
  9. **発展課題**: 応用や改善のアイデア
  10. **参考文献**: UE5公式ドキュメントや関連リソースへのURL

#### FR-003: HTML出力機能
- **説明**: 生成された教案をHTML形式で出力する
- **出力仕様**:
  - 見やすいレイアウト（セクション分け、見出し、リスト）
  - コードブロックのシンタックスハイライト
  - **Mermaid.js統合**: ブループリント図などを自動レンダリング
  - 図やスクリーンショット用のプレースホルダー（写真など）
  - **A4印刷対応**: 印刷時にA4用紙サイズに最適化されたレイアウト
  - 印刷用CSS（@media print）: ページ余白、改ページ制御、カラー調整、Mermaid図の印刷対応
  - レスポンシブデザイン（PC/タブレット対応）
  - 参考文献セクションにリンク付きURL表記
- **使用ライブラリ**:
  - Mermaid.js (CDN): https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js
  - シンタックスハイライト用ライブラリ（Prism.js or Highlight.js）

#### FR-004: 最新情報検索機能
- **説明**: UE5.6に関する最新情報を検索・取得し、教案生成に反映する
- **要件**:
  - UE5.6の公式ドキュメントから最新情報を取得
  - 古いバージョンの情報を除外する機能
  - 必要に応じてリアルタイムで情報を検索
  - MCP（Model Context Protocol）やWeb検索APIを活用
- **検索対象**:
  - UE5.6の新機能や変更点
  - コントロールリグの最新仕様
  - ブループリントのノードや関数の変更
  - 非推奨機能や推奨される代替手段
- **情報の鮮度管理**:
  - バージョン番号を常にチェック
  - "UE5.6", "Unreal Engine 5.6", "latest" などのキーワードで検索
  - 古い情報（UE4, UE5.0-5.5など）は警告または除外

### 3.2 最初の実装対象テーマ

#### Theme-001: コントロールリグを使った自作アニメーション
- **内容**: UE5のコントロールリグ機能を使って、キャラクターの独自アニメーションを作成
- **対象**: UE5初級～中級者（高校生）
- **学習ポイント**:
  - コントロールリグとは何か
  - リグの設定方法
  - アニメーションの作成とキーフレーム設定
  - ブループリントでアニメーションを再生

#### Theme-002: 必殺技演出の作成
- **内容**: 作成したアニメーションを使って、ゲーム内で必殺技の演出を実装
- **対象**: UE5初級～中級者（高校生）
- **学習ポイント**:
  - パーティクルエフェクトの追加
  - サウンドエフェクトの設定
  - カメラワークの演出
  - 入力イベントとの連携（キー入力で発動）
  - タイムライン機能の活用

## 4. 非機能要件

### 4.1 パフォーマンス
- **NFR-001**: 教案生成時間は30秒以内
- **NFR-002**: HTML出力は10秒以内

### 4.2 使いやすさ
- **NFR-003**: 教師がITに詳しくなくても使える直感的なUI
- **NFR-004**: エラーメッセージは日本語で分かりやすく表示

### 4.3 印刷品質
- **NFR-005**: A4用紙に印刷した際に読みやすいフォントサイズと行間
- **NFR-006**: 印刷時にセクションが不自然に分割されないページブレーク制御
- **NFR-007**: 参考文献のURLは印刷時にも視認可能な形式で表示

### 4.4 情報の品質と鮮度
- **NFR-008**: 生成される教案はUE5.6の最新情報に基づいていること
- **NFR-009**: 古いバージョンの情報が混入しないこと
- **NFR-010**: 参考文献にはUE5.6対応が明記されていること

### 4.5 保守性
- **NFR-011**: 新しいテーマテンプレートを追加しやすい設計
- **NFR-012**: UE5のバージョンアップに対応しやすい構造

### 4.6 拡張性（将来的）
- **NFR-013**: 複数のテーマを組み合わせた総合教案の生成
- **NFR-014**: 画像やビデオの自動生成・埋め込み
- **NFR-015**: PDF出力対応

## 5. 技術要件

### 5.1 プログラミング言語
- TypeScript（メインロジック）
- Python（将来的なAI連携用）

### 5.2 フレームワーク
- Node.js（サーバーサイド）
- 検討中：Next.js（UI追加の場合）

### 5.3 外部サービス/API
- **AI API**: 教案の自動生成
  - OpenAI API（GPT-4）
  - Anthropic Claude API
- **最新情報取得**:
  - **MCP（Model Context Protocol）**: UE5最新ドキュメントへのアクセス
  - **Web検索API**: Google/Bing/DuckDuckGo などのAPI
  - **Unreal Engine公式API**: 可能であれば公式のドキュメント検索API
- **バージョン管理**:
  - 取得した情報のUE5バージョンを識別する仕組み
  - UE5.6のキーワードでフィルタリング

### 5.4 フロントエンドライブラリ
- **Mermaid.js**: ブループリント構造図、フローチャート、タイムライン図の生成
  - バージョン: 最新版（CDN経由）
  - 対応図タイプ: graph（フローチャート）、sequenceDiagram（シーケンス図）、stateDiagram（状態遷移図）
- **Prism.js / Highlight.js**: コードのシンタックスハイライト
- 追加のCSSフレームワークは不使用（シンプルなカスタムCSS）

### 5.5 データ管理
- テーマテンプレートはJSON形式で管理
- UE5機能のナレッジベース（将来的にデータベース化）
- Mermaid.js図のテンプレートもJSON形式で管理

## 6. 制約条件

### 6.1 技術的制約
- **CON-001**: UE5の実際のプロジェクトファイルは生成しない（教案のみ）
- **CON-002**: スクリーンショットや写真は自動生成せず、プレースホルダーを配置（ただし、Mermaid.jsによるテキストベースの図生成は可能）
- **CON-003**: ブループリント構造はMermaid.jsで図示可能（フローチャート形式）。実際のUE5エディタのスクリーンショットは含まない
- **CON-004**: **対象はUE5.6のみ。古いバージョン（UE4, UE5.0-5.5）の情報は使用しない**
- **CON-005**: **情報検索時は必ずバージョン情報を確認し、最新の情報を優先する**

### 6.2 スコープ制約
- **CON-006**: Phase 1（PoC）では2つのテーマのみ実装
- **CON-007**: UIは最小限（CLI/簡易入力フォーム）
- **CON-008**: ユーザー認証や履歴管理は Phase 2 以降

## 7. 成功基準

### 7.1 Phase 1 (PoC) の完了条件
1. 2つの指定テーマで教案が正常に生成できる
2. 生成された教案にすべての必須セクションが含まれている
3. HTML出力が正しくフォーマットされている
4. **Mermaid.jsの図がブラウザで正しくレンダリングされる**
5. **A4印刷時に適切にレイアウトされている（図も含む）**
6. **参考文献にUE5.6対応のURLが含まれている**
7. 実際の高校のプログラム教室で使用可能なレベルの品質
8. 生成時間が30秒以内

### 7.2 品質基準
- **教案の内容がUE5.6の公式ドキュメントと整合している**
- **古いバージョンの情報が含まれていない**
- 高校生が理解できる平易な日本語で記述されている
- 手順に抜け漏れがない
- ブループリントの説明が具体的で実装可能
- **Mermaid.jsの図がブループリント構造を正確に表現している**
- **図が教案の説明と一致している**
- **参考文献はすべてUE5.6対応であることが明記されている**

## 8. リスクと対策

### 8.1 技術リスク
| リスク | 影響度 | 対策 |
|--------|--------|------|
| AI生成内容の品質が不安定 | 高 | テンプレートとプロンプトエンジニアリングで品質を担保 |
| **古いバージョンの情報が混入** | **高** | **検索時にUE5.6キーワードを必須化、バージョンチェック機能の実装** |
| **UE5.6の最新情報が不足** | **高** | **MCP/Web検索APIで常に最新情報を取得、公式ドキュメント優先** |
| UE5の仕様変更 | 中 | バージョン情報を教案に明記、定期的な更新 |
| 生成時間が長い | 中 | キャッシング機構の導入、段階的生成 |

### 8.2 運用リスク
| リスク | 影響度 | 対策 |
|--------|--------|------|
| 教師のITリテラシーが低い | 中 | シンプルなUI設計、詳細なマニュアル作成 |
| コスト超過（API利用料） | 低 | 使用量監視、無料枠の活用 |

## 9. スケジュール（想定）

### Phase 1: PoC開発
- **Week 1-2**: 要件定義、設計、環境構築
- **Week 3-4**: コア機能実装（教案生成エンジン）
- **Week 5**: HTML出力機能、テスト
- **Week 6**: 実際の教室での試用とフィードバック収集

### Phase 2: 機能拡張（将来）
- UI改善（Webインターフェース）
- テーマライブラリの拡充
- PDF出力対応
- 画像/動画の自動埋め込み

## 10. 備考

### 10.1 参考情報

**UE5関連**:
- **Unreal Engine 5.6 公式ドキュメント**: https://docs.unrealengine.com/ （最新版5.6を参照）
- **Control Rig in UE5**: https://docs.unrealengine.com/5.6/en-US/control-rig-in-unreal-engine/ （UE5.6対応）
- **Blueprint Visual Scripting**: https://docs.unrealengine.com/5.6/en-US/blueprints-visual-scripting-in-unreal-engine/ （UE5.6対応）
- **Unreal Engine リリースノート**: https://docs.unrealengine.com/5.6/en-US/unreal-engine-5-6-release-notes/

**図生成ライブラリ**:
- **Mermaid.js 公式サイト**: https://mermaid.js.org/
- **Mermaid.js ドキュメント**: https://mermaid.js.org/intro/
- **Mermaid Live Editor**: https://mermaid.live/ （図のテスト用）

**注意**: すべてのURLはUE5.6対応版を参照すること。古いバージョン（5.0, 5.1など）のドキュメントは使用しない。

### 10.2 用語定義
- **UE5.6**: Unreal Engine 5 バージョン5.6。本プロジェクトの対象バージョン
- **コントロールリグ**: UE5のアニメーションシステムで、キャラクターのボーンを制御するためのツール
- **ブループリント**: UE5のビジュアルスクリプティングシステム
- **アニメーションブループリント**: キャラクターのアニメーション制御専用のブループリント
- **タイムライン**: UE5のブループリント内で時間経過に基づくアニメーションや値の変化を制御する機能
- **必殺技演出**: ゲームキャラクターの特殊攻撃の視覚的・聴覚的な表現
- **MCP（Model Context Protocol）**: AIモデルが外部データソースにアクセスするためのプロトコル。最新ドキュメントの取得に使用
- **Mermaid.js**: テキストベースで図を記述し、HTMLで自動レンダリングできるJavaScriptライブラリ。フローチャート、シーケンス図、状態遷移図などに対応
